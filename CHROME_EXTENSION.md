# Chrome Extension - LinkedIn Job Capture

This Chrome extension allows you to quickly capture job opportunities from LinkedIn and save them to your Job Application Tracker.

## Features

- **One-click capture**: Extract job details from LinkedIn job postings automatically
- **Editable form**: Review and edit captured data before saving
- **Sync with web app**: Automatically syncs with the web application when open
- **Offline storage**: Uses Chrome's storage API for reliable data persistence
- **Manual creation**: Add opportunities directly from the web app (no extension needed)
- **Bidirectional sync**: Opportunities sync between extension and web app in real-time
- **Memory efficient**: Proper cleanup of timers prevents memory leaks

## Installation

### Development Build

1. Build the extension:
   ```bash
   npm run build:extension
   ```

2. Open Chrome and navigate to `chrome://extensions/`

3. Enable "Developer mode" (toggle in the top right)

4. Click "Load unpacked"

5. Select the `chrome-extension/dist` directory

6. The extension should now appear in your extensions list

### Adding Icons

The extension requires icons for proper display. Create or add the following icon files to `chrome-extension/`:
- `icon16.png` (16x16 pixels)
- `icon48.png` (48x48 pixels)
- `icon128.png` (128x128 pixels)

You can use any image editor or online tool to create these icons. The extension will work without icons, but Chrome will show a default placeholder.

## Usage

### Capturing a Job Opportunity

1. Navigate to a LinkedIn job posting (e.g., `https://www.linkedin.com/jobs/view/...`)

2. Click the extension icon in your Chrome toolbar

3. The popup will automatically extract:
   - Job title/position
   - Company name
   - Location
   - Job type (Remote/Hybrid/On-site)
   - Description
   - Salary (if available)
   - Posted date

4. Review and edit the captured data as needed

5. Click "Save to Opportunities" to save the job opportunity

6. The opportunity will appear in the "Opportunities" page of your web application

### Adding Opportunities Manually

You can also add opportunities directly from the web app without using the extension:

1. Open the Job Application Tracker web app

2. Navigate to the "Opportunities" page (click the "Opportunities" button in the header)

3. Click the "+ Add Opportunity" button

4. Fill in the form with job details:
   - Position (required)
   - Company (required)
   - Link (required)
   - Location (optional)
   - Job Type (optional)
   - Salary (optional)
   - Description (optional)
   - Posted Date (optional)

5. Click "Save Opportunity" to add it to your list

6. The opportunity will automatically sync with the extension if it's installed

### Converting to Application

1. Open the Job Application Tracker web app

2. Navigate to the "Opportunities" page (click the "Opportunities" button in the header)

3. Review your saved opportunities

4. Click "Apply" on any opportunity to convert it to a job application

5. The opportunity will be moved to your applications list with status "Applied"

6. The opportunity will be removed from the opportunities list and extension storage

## Architecture

### Files Structure

```
chrome-extension/
├── manifest.json          # Extension manifest (Chrome extension config)
├── popup.html             # HTML container for the popup UI
├── popup.tsx              # React component for the popup form
├── content.ts             # Content script that runs on LinkedIn pages
├── webapp-content.ts      # Content script injected into web app for sync
├── background.ts          # Background service worker
├── job-extractors/        # Job extraction system
│   ├── JobExtractor.ts    # Interface for job extractors
│   ├── LinkedInJobExtractor.ts  # LinkedIn-specific extractor
│   └── index.ts           # Extractor registry
└── dist/                  # Built files (generated by build:extension)
    ├── popup.js
    ├── content.js
    ├── webapp-content.js
    ├── background.js
    ├── manifest.json
    └── popup.html
```

### Components

#### Content Script (`content.ts`)
- Runs on LinkedIn job posting pages
- Extracts job data from the DOM using CSS selectors
- Responds to messages from the popup
- Syncs data with the web app via `postMessage`

#### Popup (`popup.tsx`)
- React-based UI for reviewing and editing captured data
- Communicates with content script to get job data
- Saves opportunities to `chrome.storage.local`
- Provides button to open the web application

#### Background Service Worker (`background.ts`)
- Handles extension lifecycle events
- Manages cross-tab communication
- Syncs data between extension and web app

#### Web App Content Script (`webapp-content.ts`)
- Injected into the web application pages
- Syncs opportunities from `chrome.storage.local` to `localStorage`
- Listens for `window.postMessage` from the web app
- Handles delete and sync operations
- Manages timers with proper cleanup to prevent memory leaks

### Data Flow

1. **Capture**: User opens popup on LinkedIn job page
   - Popup requests data from content script
   - Content script extracts data from DOM
   - Data sent back to popup

2. **Save**: User clicks "Save to Opportunities"
   - Data saved to `chrome.storage.local`
   - Background script attempts to sync with web app
   - Web app receives data via `postMessage` or `localStorage` events

3. **Sync**: Web app receives new opportunity
   - Listener in `HomePage` detects new opportunity
   - Shows success notification
   - Header badge updates automatically

4. **Manual Creation**: User adds opportunity from web app
   - Form data saved to `localStorage`
   - `window.postMessage` sends `SYNC_OPPORTUNITY` to extension
   - Extension content script receives message and syncs to `chrome.storage.local`
   - Bidirectional sync ensures consistency

5. **Delete**: User deletes opportunity from web app
   - Opportunity removed from `localStorage`
   - `window.postMessage` sends `DELETE_OPPORTUNITY` to extension
   - Extension removes opportunity from `chrome.storage.local`
   - Sync back to `localStorage` to reflect deletion

## Development

### Building

```bash
npm run build:extension
```

This will:
1. Compile TypeScript files (popup.tsx, content.ts, background.ts)
2. Bundle React components and dependencies
3. Copy manifest.json and popup.html to dist/
4. Copy icon files if they exist

### Testing

1. Build the extension
2. Load it in Chrome as described in Installation
3. Navigate to a LinkedIn job posting
4. Test the capture and save functionality
5. Verify sync with the web app

### Debugging

- **Popup**: Right-click extension icon → "Inspect popup"
- **Content Script**: Open DevTools on LinkedIn page → Check Console
- **Background**: Go to `chrome://extensions/` → Click "service worker" link

## Permissions

The extension requires the following permissions:

- **storage**: To save opportunities in Chrome's storage
- **activeTab**: To access the current tab's URL and content
- **scripting**: To inject content scripts on LinkedIn pages
- **host_permissions**: Access to `linkedin.com` for content script injection and web app domains for sync

### Externally Connectable

The extension includes `externally_connectable` configuration in `manifest.json` to allow the web application to communicate with the extension via `window.postMessage`. This enables:
- Real-time sync between web app and extension
- Delete operations from web app
- Manual opportunity creation sync

## Limitations

1. **LinkedIn Selectors**: The extension relies on LinkedIn's DOM structure. If LinkedIn changes their HTML structure, the selectors may need to be updated.

2. **Cross-Origin Storage**: The extension uses `chrome.storage.local` which is separate from the web app's `localStorage`. Sync happens via `postMessage` or periodic polling.

3. **SPA Navigation**: LinkedIn uses single-page application (SPA) navigation. The content script includes a mutation observer to detect page changes.

4. **Message Origin**: `window.postMessage` requires the web app to send messages with the correct origin. The extension listens for messages from the same origin as the web app.

## Troubleshooting

### Popup shows "Loading job data..." indefinitely
- Make sure you're on a LinkedIn job posting page (`/jobs/view/...`)
- Check browser console for errors
- Try refreshing the page and opening the popup again

### Data not syncing with web app
- Make sure the web app is open in a browser tab
- Check that both extension and web app are using the same origin (localhost or production domain)
- Verify `externally_connectable` is configured in `manifest.json`
- Check browser console for message errors
- Try manually refreshing the Opportunities page
- Check that `webapp-content.js` is loaded (check Network tab in DevTools)

### Delete operation not working
- Verify the extension is installed and enabled
- Check browser console for `DELETE_OPPORTUNITY` messages
- Ensure `externally_connectable` matches your web app domain
- Check that `webapp-content.js` is running (look for extension logs in console)
- Try reloading the extension in `chrome://extensions/`

### Memory issues or performance problems
- The extension now properly cleans up timers to prevent memory leaks
- If you notice performance issues, check the browser's task manager
- Reload the extension if timers seem to accumulate

### Extension icon not appearing
- Check that icons are in `chrome-extension/dist/` after build
- Verify manifest.json references the correct icon paths
- Reload the extension in `chrome://extensions/`

## Future Enhancements

- [ ] Support for other job boards (Indeed, Glassdoor, Greenhouse, Lever, Workday, etc.)
- [ ] Batch capture (save multiple jobs at once)
- [ ] Direct application from extension
- [ ] Custom field mapping
- [ ] Export/import opportunities
- [ ] Notification when new opportunities are captured
- [ ] Extension detection and installation prompt in web app
- [ ] Video mini-tutorial for extension usage
- [ ] Advanced filtering and search in extension popup

## Related Documentation

- [README.md](./README.md) - Main project documentation
- [RECOMMENDATIONS.md](./RECOMMENDATIONS.md) - Feature roadmap and recommendations

